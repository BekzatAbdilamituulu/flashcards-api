<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="820" viewBox="0 0 1200 820">
  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0" stop-color="#0b1220"></stop>
      <stop offset="1" stop-color="#0a0f1a"></stop>
    </linearGradient>

    <linearGradient id="tbl" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0" stop-color="#121a2b"></stop>
      <stop offset="1" stop-color="#0f1626"></stop>
    </linearGradient>

    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="6" stdDeviation="10" flood-color="#000" flood-opacity="0.5"></feDropShadow>
    </filter>

    <style>
      .title { font: 800 26px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial; fill: #e6edf3; }
      .subtitle { font: 400 14px ui-sans-serif, system-ui; fill: #9fb0c3; }
      .table { fill: url(#tbl); stroke: #2a3a55; stroke-width: 1.2; rx: 18; filter: url(#shadow); }
      .tname { font: 800 15px ui-sans-serif, system-ui; fill: #e6edf3; }
      .col { font: 500 12.5px ui-sans-serif, system-ui; fill: #b9c7d6; }
      .pk { fill: #cfe3ff; font-weight: 800; }
      .fk { fill: #ffd6a5; font-weight: 800; }
      .muted { fill: #93a4b7; }
      .line { stroke: #5b7aa8; stroke-width: 2; fill: none; }
      .dline { stroke: #5b7aa8; stroke-width: 2; fill: none; stroke-dasharray: 6 6; }
      .note { font: 500 12px ui-sans-serif, system-ui; fill: #c7d5e0; }
    </style>

    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="9" markerHeight="9" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#5b7aa8"></path>
    </marker>
  </defs>

  <rect width="1200" height="820" fill="url(#bg)"></rect>

  <!-- Header -->
  <text x="60" y="70" class="title">Flashcards API (v2) — Database ER Diagram</text>
  <text x="60" y="98" class="subtitle">Core tables and relationships (Deck/Card + per-user progress)</text>

  <!-- USERS -->
  <rect x="60" y="140" width="320" height="190" class="table"></rect>
  <text x="86" y="172" class="tname">users</text>
  <text x="86" y="200" class="col"><tspan class="pk">PK</tspan> id : int</text>
  <text x="86" y="222" class="col">username : str (unique)</text>
  <text x="86" y="244" class="col">hashed_password : str</text>
  <text x="86" y="266" class="col">daily_card_target : int</text>
  <text x="86" y="288" class="col muted">created_at : datetime (optional)</text>

  <!-- DECKS -->
  <rect x="460" y="140" width="340" height="200" class="table"></rect>
  <text x="486" y="172" class="tname">decks</text>
  <text x="486" y="200" class="col"><tspan class="pk">PK</tspan> id : int</text>
  <text x="486" y="222" class="col"><tspan class="fk">FK</tspan> owner_id : int → users.id</text>
  <text x="486" y="244" class="col">title : str</text>
  <text x="486" y="266" class="col">is_public : bool</text>
  <text x="486" y="288" class="col muted">created_at : datetime (optional)</text>
  <text x="486" y="310" class="col muted">share_code : str (optional)</text>

  <!-- CARDS -->
  <rect x="860" y="140" width="300" height="220" class="table"></rect>
  <text x="886" y="172" class="tname">cards</text>
  <text x="886" y="200" class="col"><tspan class="pk">PK</tspan> id : int</text>
  <text x="886" y="222" class="col"><tspan class="fk">FK</tspan> deck_id : int → decks.id</text>
  <text x="886" y="244" class="col">front : str</text>
  <text x="886" y="266" class="col">back : str</text>
  <text x="886" y="288" class="col muted">created_at : datetime (optional)</text>
  <text x="886" y="310" class="col muted">updated_at : datetime (optional)</text>

  <!-- USER_CARD_PROGRESS -->
  <rect x="500" y="420" width="430" height="290" class="table"></rect>
  <text x="526" y="452" class="tname">user_card_progress</text>
  <text x="526" y="480" class="col"><tspan class="pk">PK</tspan> (user_id, card_id) composite</text>
  <text x="526" y="502" class="col"><tspan class="fk">FK</tspan> user_id : int → users.id</text>
  <text x="526" y="524" class="col"><tspan class="fk">FK</tspan> card_id : int → cards.id</text>
  <text x="526" y="548" class="col">times_seen : int</text>
  <text x="526" y="570" class="col">times_correct : int</text>
  <text x="526" y="592" class="col">repetitions : int</text>
  <text x="526" y="614" class="col">interval : int (days)</text>
  <text x="526" y="636" class="col">ease_factor : float</text>
  <text x="526" y="658" class="col">last_review : datetime</text>
  <text x="526" y="680" class="col">next_review : datetime</text>

  <!-- DECK_ACCESS (optional sharing) -->
  <rect x="60" y="420" width="360" height="210" class="table"></rect>
  <text x="86" y="452" class="tname">deck_access (optional)</text>
  <text x="86" y="480" class="col"><tspan class="pk">PK</tspan> id : int (or composite)</text>
  <text x="86" y="502" class="col"><tspan class="fk">FK</tspan> user_id : int → users.id</text>
  <text x="86" y="524" class="col"><tspan class="fk">FK</tspan> deck_id : int → decks.id</text>
  <text x="86" y="548" class="col">access_level : str (viewer/editor)</text>
  <text x="86" y="570" class="col muted">unique(user_id, deck_id)</text>
  <text x="86" y="592" class="col muted">created_at : datetime (optional)</text>

  <!-- DAILY_PROGRESS (optional) -->
  <rect x="960" y="420" width="200" height="200" class="table"></rect>
  <text x="986" y="452" class="tname">daily_progress (optional)</text>
  <text x="986" y="480" class="col"><tspan class="pk">PK</tspan> id : int</text>
  <text x="986" y="502" class="col"><tspan class="fk">FK</tspan> user_id : int → users.id</text>
  <text x="986" y="524" class="col">date : date</text>
  <text x="986" y="548" class="col">cards_done : int</text>
  <text x="986" y="570" class="col muted">unique(user_id, date)</text>

  <!-- Relationships -->
  <!-- users -> decks -->
  <path d="M 380 210 C 410 210, 430 210, 460 210" class="line" marker-end="url(#arrow)"></path>
  <text x="405" y="200" class="note">1 → many</text>

  <!-- decks -> cards -->
  <path d="M 800 240 C 825 240, 840 240, 860 240" class="line" marker-end="url(#arrow)"></path>
  <text x="820" y="230" class="note">1 → many</text>

  <!-- users -> user_card_progress -->
  <path d="M 220 330 C 220 360, 280 390, 500 470" class="line" marker-end="url(#arrow)"></path>
  <text x="250" y="380" class="note">1 → many</text>

  <!-- cards -> user_card_progress -->
  <path d="M 1010 360 C 1010 390, 980 410, 930 470" class="line" marker-end="url(#arrow)"></path>
  <text x="985" y="410" class="note">1 → many</text>

  <!-- users -> deck_access -->
  <path d="M 160 330 C 150 360, 130 380, 120 420" class="dline" marker-end="url(#arrow)"></path>
  <text x="80" y="380" class="note">optional</text>

  <!-- decks -> deck_access -->
  <path d="M 520 340 C 420 380, 300 400, 240 420" class="dline" marker-end="url(#arrow)"></path>

  <!-- users -> daily_progress -->
  <path d="M 320 300 C 520 340, 860 360, 980 420" class="dline" marker-end="url(#arrow)"></path>

  <!-- Footer note -->
  <text x="60" y="780" class="subtitle">
    Notes: “deck_access” and “daily_progress” are optional features; the core learning loop is users ↔ cards via user_card_progress.
  </text>
</svg>
